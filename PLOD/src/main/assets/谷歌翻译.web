{
	,"host": "https://translate.google.cn"
	,"index": ""
	,"style": "header,.VjFXz{display:none!important}#gtyexp{display:none;position:fixed;width:35px;height:35px;top:8px;right:25px;background-color:rgb(181 217 255);transition:all 0.25s;opacity:0.75;z-index:999;border-radius:3px;padding:10px;user-select:none;box-shadow:rgb(0 0 255 / 20%) 0px 7px 19px 0px;}"
	,"search": "/?sl=auto&tl=zh-CN&text=%s&op=translate"
	,"searchx": [
		{keyx:"^[\u4e00-\u9fa5]", value:"/?sl=auto&tl=en&op=translate&text="}
	]
	,"keyPattern": "*"
	,"js": "
	var e = document.getElementById('gtyexp'),win=window,sel=win.getSelection()
	,ta=document.getElementsByTagName('textarea')[0], listPane,textPara;
	function debug(e){console.log(e)};
	debug('translator ini...'); // 开始
	win._YWPC=['Sp3AF'];
	var ety=e;
	function sc(v){
		if(sel.type!='Range') ety.style.display = 'none';
		else if(ety.style.display=='none'){
			ety.style.display = 'block';
			ety.style.opacity = 0.75;
		}
	}
	if(!e) {
		e=document.createElement('IMG');
		e.id='gtyexp';
		document.body.appendChild(e);
		e.src='//ssl.gstatic.com/translate/favicon.ico'; // 谷歌翻译的图标
		var PDRNG,PDRNT;
		function toggle(){ 
			if(!sel.toStringRaw) { // 强硬作风 温和修改
				sel.toStringRaw = sel.toString;
				sel.toString = function(){
					debug('fatal toString='+PDRNG); 
					var ret = sel.toStringRaw();
					if(PDRNG) {
						debug('fatal sustain the selection v3='+PDRNG); 
						ret = PDRNG.toString();
						sel.removeAllRanges();
						sel.addRange(PDRNG);
						PDRNG = 0;
					}
					return ret
				}
			}
			ta.dispatchEvent(new KeyboardEvent('keydown', {
				keyCode: 0x10,
				bubbles: 1
			}));
			function isChildOf(c, p) {
				return p&&SearchElement(p);
				function SearchElement(ele) {
					if (!ele) return 0;
					return ele===c
						|| SearchElement(ele.firstChild) 
						|| SearchElement(ele.nextSibling);
				}
			}
			function getTop(e){
			  var offset=e.offsetTop;
			  if(e.offsetParent!=null) offset+=getTop(e.offsetParent);
			  return offset;
			}
			var rng=sel.getRangeAt(0),key=rng.toString(),an=sel.anchorNode;
			if(an!==ta.parentElement) 
			{
				PDRNG=rng.cloneRange();
				var exp=document.getElementsByClassName('J0lOec')[0];
				if(!isChildOf(an,exp)) {
					rng.selectNode(exp);
					app.knock1(sid.get(),exp.offsetWidth/2, getTop(exp));
				} else {
					app.knock(sid.get());
				}
				clearTimeout(PDRNT);
				//PDRNT = setTimeout(v=>{PDRNG=0}, 1800);
			}
			ta.dispatchEvent(new KeyboardEvent('keyup', {
				keyCode: 0x10,
				bubbles: 1
			}));
			debug('检查是否查到了单词释义');
			if(false)
			setTimeout(function(){
				//if(document.getElementsByClassName('aia4Ud')[0].firstElementChild.innerText===key) 
				if(1)
				{
					e.style.transition='';
					e.style.transform='scale(1.5)';
					e.style.transition='all 0.25s';
					setTimeout(function(){e.style.transform='unset'}, 80);
					//e.style.transform='unset'
				}
			}, 200);
		}
		e.onclick=toggle;
		document.addEventListener('selectionchange', sc);
	}
	function isAttached(e) {
		while(e&&(e=e.parentElement)) {
			if(e===document.body)return true;
		}
		return false;
	}
	function queryByAttr(aAttribute, aValue, abody) {
		return SearchElement(abody||document.body);
		function ElementVerifier(ele) {
			var Element = ele;
			if (Element.nodeName!=='#text' && ele.getAttribute(aAttribute)===aValue)
				//return eval('Element.' + aAttribute + '==\\'' + aValue + '\\'?true:false;');
				return ele;
			return 0;
		}
		function SearchElement(ele) {
			if (!ele) return 0;
			return ElementVerifier(ele) 
				|| SearchElement(ele.firstChild) 
				|| SearchElement(ele.nextSibling);
		}
	}
	// 默认不编辑输入框
	function tweakInput(){
		if(!isAttached(ta)) {
			win._tweakedHXCL=0;
			ta=document.getElementsByTagName('textarea')[0];
		}
		if(ta && !ta.getAttribute('_PDSC')) {
			ta.addEventListener('selectionchange', sc);
			if(ta!=document.activeElement)ta.readOnly=true;
			ta.setAttribute('_PDSC', '');
		}
	}
	// 点击不显示候选列表
	const observer=new MutationObserver(function(mutationsList, observer) {
		for(var i=0;i<mutationsList.length;i++) {
			var mutation = mutationsList[i];
			if (mutation.type==='attributes' && mutation.attributeName==='style') {
				//console.log('The ' + mutation.attributeName + ' attribute was modified.');
				if(listPane.style.display=='') { // 若正常显示候选列表
					listPane.style.display='none'; // 重新隐藏候选列表
					observer.disconnect();
				}
			}
		}
	});
	function obz(){
		observer.observe(listPane, { attributes: true
			, attributeFilter : ['style'] });
	}
	const observer1=new MutationObserver(function(mutationsList, observer) {
		for(var i=0;i<mutationsList.length;i++) {
			var mutation = mutationsList[i];
			if (mutation.attributeName==='aria-label') {
				var e=mutation.target;
				if(e.getAttribute('aria-label')!==e.getAttribute('data-aria-label-on')) {
					observer1.disconnect();
					app.onAudioPause();
				}
			}
		}
	});
	function obz1(e){
		observer1.observe(e, { attributes: true
			, attributeFilter : ['aria-label'] });
	}
	function tweakHXCL(){ // 调整候选表
		var jn='jsname',cp=queryByAttr(jn, 'r5xl4'); // 解释内容容器
		function Qa(jsname, p){return queryByAttr(jn, jsname, p||cp)}
		function check(){
			if(win._tweakedHXCL) tweakInput();
			if(!win._tweakedHXCL) {
				setTimeout(tweakHXCL, 350);
				if(!isAttached(cp)) cp=queryByAttr(jn, 'r5xl4');
			}
		}
		tweakInput();
		function tweakInputMod(){
			if(!isAttached(win._modin)) {
				var n;
				if(!win._modin) {
					//var e=Qa('rhPddf').cloneNode(true); // 拷贝编辑按钮 2021翻译门事件后取消编辑按钮
					var e=Qa('kImuFf').cloneNode(true); // 拷贝复制按钮
					n = e.getElementsByTagName('I')[0];
					win._modin=e;
					if(n){
						n.style.color='#888';
						n.innerText='edit';
					}
					e.onclick=function(v){
						ta.readOnly=!ta.readOnly;
						if(n)n.style.color=ta.readOnly?'#888':'#000';
						v.stopPropagation();
					}
				}
				document.getElementsByClassName('FFpbKc')[0].appendChild(win._modin); // 添加到输入内容，字数栏之后
			}
		}
		tweakInputMod();
		if(!win._RPGF) {
			// mod the share btn
			win.addEventListener('click', function(v){
				var p=v.srcElement.parentElement;
				if(p) {
					var jn=p.getAttribute('jsname');
					if(jn==='ymIaV' && !v.srcElement.onclick) {
						v.srcElement.onclick=function(u){
							debug('fatal 123');
							if(!listPane) {
								listPane = Qa('HyaQwf');
								listPane.style.display='none'; //  hide the list pane
							}
							(textPara||Qa('W297wb')).click();  // clk on txt to show list pane
							listPane.style.display='';
							u.preventDefault();
							u.stopPropagation();
							obz();
							tweakInputMod();
							return false;
						};
					}
					else if(jn==='UsVyAb') {
						app.onAudioPlay();
						obz1(p);
					}
				}
				//debug('fatal 123asd '+p.parentElement.className+' jn='+p.parentElement.getAttribute('jsname'));
				if(p.parentElement.className==='VIiyi') {
					debug('fatal click on text');
					check();
					textPara = v.srcElement;
					listPane = Qa('HyaQwf', p); // force hide the list pane
					if(listPane.style.display!='none')
						listPane.style.display='none';
				}
			}, true);
			win._RPGF=1;
		}
		
		debug('点击不显示候选列表', listPane = Qa('HyaQwf'));
		win._tweakedHXCL=true;
		debug('点击不显示候选列表 done.');
	}
	
	tweakInput();
	
	win._tweakHXCL = tweakHXCL;
	if(!win._tweakedHXCL)
		setTimeout(tweakHXCL, 1350);
	
	debug('translator init done.'); // 结束
	"
	,"searchJs": "var succ = 0;
function debug(e){console.log(e)};
try {
	debug('searchJs');
	function isAttached(e) {
		while(e&&(e=e.parentElement)) {
			if(e===document.body)return true;
		}
		return false;
	}
	var ta=window._pdta,tl=1,i=0;
	if(!isAttached(ta)){
		var tat = document.getElementsByTagName('textarea');
		for (ta=tat[0],tl=tat.length; i < tl; i++) if (tat[i].getAttribute('aria-label') === '原文') {
			ta=tat[i];
			window._pdta=ta;
			break;
		}
	}
	debug('fatal ta='+ta+' len='+tl+' wta='+window._pdta);
	if (ta) {
		ta.value = '%s';
		ta.dispatchEvent(new Event('input', {
			bubbles: true
		}));
		setTimeout(function(){
			ta.dispatchEvent(new KeyboardEvent('keydown', {
				keyCode: 27,
				bubbles: 1
			}))
		}, 200);
		succ = i < tl;
		//window._tweakedHXCL = false; setTimeout(window._tweakHXCL, 350);
	}
} catch (e) {
	debug('fatal e='+e);
}
succ"
	,"translator":"true"
	,"drawHighlightOnTop":"true"
}